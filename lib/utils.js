import { keccak256 } from "@ethersproject/solidity";
import { ZqField } from 'ffjavascript';
/*
  This is the "Baby Jubjub" curve described here:
  https://iden3-docs.readthedocs.io/en/latest/_downloads/33717d75ab84e11313cc0d8a090b636f/Baby-Jubjub.pdf
*/
export const SNARK_FIELD_SIZE = BigInt("21888242871839275222246405745257275088548364400416034343698204186575808495617");
// Creates the finite field
export const Fq = new ZqField(SNARK_FIELD_SIZE);
/**
 * Generates an External Nullifier for use with RLN.
 * @param plaintext String. //TODO: better description
 * @returns External Nullifier in a string.
 */
export function genExternalNullifier(plaintext) {
    const hashed = keccak256(["string"], [plaintext]);
    const hexStr = `0x${hashed.slice(8)}`;
    const len = 32 * 2;
    const h = hexStr.slice(2, len + 2);
    return `0x${h.padStart(len, "0")}`;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLHlCQUF5QixDQUFBO0FBQ25ELE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxjQUFjLENBQUE7QUFFdEM7OztFQUdFO0FBQ0YsTUFBTSxDQUFDLE1BQU0sZ0JBQWdCLEdBQUcsTUFBTSxDQUFDLCtFQUErRSxDQUFDLENBQUE7QUFFdkgsMkJBQTJCO0FBQzNCLE1BQU0sQ0FBQyxNQUFNLEVBQUUsR0FBRyxJQUFJLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFBO0FBRS9DOzs7O0dBSUc7QUFDSCxNQUFNLFVBQVUsb0JBQW9CLENBQUMsU0FBaUI7SUFDcEQsTUFBTSxNQUFNLEdBQUcsU0FBUyxDQUFDLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFBO0lBQ2pELE1BQU0sTUFBTSxHQUFHLEtBQUssTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFBO0lBQ3JDLE1BQU0sR0FBRyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUE7SUFDbEIsTUFBTSxDQUFDLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFBO0lBRWxDLE9BQU8sS0FBSyxDQUFDLENBQUMsUUFBUSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsRUFBRSxDQUFBO0FBQ3BDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBrZWNjYWsyNTYgfSBmcm9tIFwiQGV0aGVyc3Byb2plY3Qvc29saWRpdHlcIlxuaW1wb3J0IHsgWnFGaWVsZCB9IGZyb20gJ2ZmamF2YXNjcmlwdCdcblxuLypcbiAgVGhpcyBpcyB0aGUgXCJCYWJ5IEp1Ymp1YlwiIGN1cnZlIGRlc2NyaWJlZCBoZXJlOlxuICBodHRwczovL2lkZW4zLWRvY3MucmVhZHRoZWRvY3MuaW8vZW4vbGF0ZXN0L19kb3dubG9hZHMvMzM3MTdkNzVhYjg0ZTExMzEzY2MwZDhhMDkwYjYzNmYvQmFieS1KdWJqdWIucGRmXG4qL1xuZXhwb3J0IGNvbnN0IFNOQVJLX0ZJRUxEX1NJWkUgPSBCaWdJbnQoXCIyMTg4ODI0Mjg3MTgzOTI3NTIyMjI0NjQwNTc0NTI1NzI3NTA4ODU0ODM2NDQwMDQxNjAzNDM0MzY5ODIwNDE4NjU3NTgwODQ5NTYxN1wiKVxuXG4vLyBDcmVhdGVzIHRoZSBmaW5pdGUgZmllbGRcbmV4cG9ydCBjb25zdCBGcSA9IG5ldyBacUZpZWxkKFNOQVJLX0ZJRUxEX1NJWkUpXG5cbi8qKlxuICogR2VuZXJhdGVzIGFuIEV4dGVybmFsIE51bGxpZmllciBmb3IgdXNlIHdpdGggUkxOLlxuICogQHBhcmFtIHBsYWludGV4dCBTdHJpbmcuIC8vVE9ETzogYmV0dGVyIGRlc2NyaXB0aW9uXG4gKiBAcmV0dXJucyBFeHRlcm5hbCBOdWxsaWZpZXIgaW4gYSBzdHJpbmcuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZW5FeHRlcm5hbE51bGxpZmllcihwbGFpbnRleHQ6IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0IGhhc2hlZCA9IGtlY2NhazI1NihbXCJzdHJpbmdcIl0sIFtwbGFpbnRleHRdKVxuICBjb25zdCBoZXhTdHIgPSBgMHgke2hhc2hlZC5zbGljZSg4KX1gXG4gIGNvbnN0IGxlbiA9IDMyICogMlxuICBjb25zdCBoID0gaGV4U3RyLnNsaWNlKDIsIGxlbiArIDIpXG5cbiAgcmV0dXJuIGAweCR7aC5wYWRTdGFydChsZW4sIFwiMFwiKX1gXG59XG4iXX0=